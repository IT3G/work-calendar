<div class="sticky-header">
  <app-project-teams-filter
    [filtersForm]="filtersForm"
    [subdivision]="subdivisionData"
    [isMobileVersion]="isMobileVersion"
  ></app-project-teams-filter>

  <mat-form-field>
    <mat-label>Вид</mat-label>
    <mat-select [(value)]="selected">
      <mat-option value="option1">по проектам</mat-option>
      <mat-option value="option2">по регионам</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<div class="projects-grid">
  <div class="location" *ngFor="let loc of location">
    {{ loc }}
  </div>
</div>
<div class="projects-grid">
  <ng-container *ngFor="let project of projectsData | projectTeamsFilter: filtersForm.value" class="project-table">
    <app-projects-title
      [date]="filtersForm.get('month').value"
      [project]="project"
      [subdivisionData]="subdivisionData"
    ></app-projects-title>

    <ng-container
      *ngTemplateOutlet="isMobileVersion ? mobileTable : desktopTable; context: { project: project }"
    ></ng-container>
  </ng-container>
</div>

<ng-template #mobileTable let-project="project">
  <ng-container *ngFor="let loc of location">
    <div *ngFor="let user of project.users | userForLocation: loc">
      <app-user-card
        [user]="user"
        [isMobileVersion]="isMobileVersion"
        [projectId]="project.projectId"
        [date]="filtersForm.get('month').value"
      ></app-user-card>
    </div>
  </ng-container>
</ng-template>

<ng-template #desktopTable let-project="project">
  <div class="border desktop-item" *ngFor="let loc of location">
    <div *ngFor="let user of project.users | userForLocation: loc">
      <app-user-card
        [user]="user"
        [projectId]="project.projectId"
        [date]="filtersForm.get('month').value"
      ></app-user-card>
    </div>
  </div>
</ng-template>

<!-- <app-user-for-location-table></app-user-for-location-table> -->

<div class="location-grid">
  <div class="location-row" *ngFor="let loc of location">
    <div class="location-p">{{ loc }}</div>
    <ng-container *ngFor="let project of projectsData | projectTeamsFilter: filtersForm.value">
      <div *ngFor="let user of project.users | userForLocation: loc">
        <app-user-card [user]="user" [date]="filtersForm.get('month').value"></app-user-card>
      </div>
    </ng-container>
  </div>
</div>

<div class="loader-container" *ngIf="loadInProgress">
  <app-spring-spinner [animationDuration]="1000" [size]="80" color="#90caf9"></app-spring-spinner>
</div>
