language: node_js
node_js:
- '12'
dist: trusty
sudo: required
branches:
  only:
  - ci
before_script:
- cd frontend
- npm install -g yarn
- npm install -g @angular/cli
script:
- yarn install
- npm run build:test
deploy:
  - provider: pages
    skip_cleanup: true
    github_token: "$GITHUB_TOKEN"
    local_dir: frontend/dist/work-calendar
    on:
      branch: ci
  - provider: heroku
    edge: true
    skip_cleanup: true
    api_key:
      secure: B9kXeTBKM2VQAapa94lFbOdUrhDnwJuHA9TIWiEP+iFaHgR+ZIzo8FAqCLBmBxKLQw6X0AaOD5luKhXhNHT0uwrIx6NWDe3Ff0Pad1hNUcqyqlU/sHOeIokVTXZKxUhqWVHUPORhRIDwJZC6Nrs75TsYwQSFusZzTrIJvpfxRt5FFoBK5zKRYKvAX8L1bia/rhSOhQEpgaiKDtI5J1xXjZHJsxQlar8tWZPaZ9n6VjIjMnhUglVlwacpXEaHzBakUNsrrRvr7/Uhurn13Wss43EP1ykzXw7elveAffpsabCVJg4LRgSSTuy80rk9ROuykyCzIjAAOknQe1WJj3xkZyoHSP5BAsAAZ8dyuD7fVRMk9CTdrgE/gfdrVdvIjiCrtfz41g3RjIscpGHqAi+W9H/78uKBRzk2gnzlgZqM8O7wj/a2KlMGma6stPNmagbl5Yip1VIX0rpYl9vMUMJo0jDaltYaRmptmu1vv/+MMfgA8dAQ3A7dqCdpPQUUFaKRuga4vToTq9NKuNTlVSk4A4sjLjDytuimeVJgdll6ieDfVs99bza2h7MSWwdfNcGxskdtd+iG/rD5Qvg67+AKlKSrh3rBl6lOkDcGS3OqOnAF3H/10wrzUkXoXOy+gorYWvOQHfN/yCHKk3HC3+69pdiF2Zj7ongdbcGogmzf6Rg=
    app: work-cal
    on:
      branch: ci
