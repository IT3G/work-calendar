language: node_js
node_js:
- '12'
dist: trusty
sudo: required
branches:
  only:
  - ci
before_script:
- cd frontend
- npm install -g yarn
- npm install -g @angular/cli
script:
- yarn install
- npm run build:test
deploy:
  - provider: pages
    skip_cleanup: true
    github_token: "$GITHUB_TOKEN"
    local_dir: frontend/dist/work-calendar
    on:
      branch: ci
  - provider: heroku
    edge: true
    skip_cleanup: true
    api_key:
      secure: "iVPEM+t9b+pvBfWPkCe4MwdY1XH8qq4fcvjeJp+OxM01nzPB2FPZ5eXwGqK7XczuObGcjcPTsdx6FvX3IYIkj8toA7EfmuEKmXPUmRVQrpPLL/06qQ856eHMtLC/WcGjbPNxBx9rVuCAdytpaC+UMoZWtW+uZ3/4HLBCqEbLyETSMJrDIQcnLyTi/8ERNxYR5kTW2rlviqhffObK33MCLPBiepwztgOFVLHfarw5yMvJM8Swkqdb1u3zLo3Oc/x5geviOE9D7sDn6/DHODIOWFaUycfbIixUnQhSapkTrF5AIUeravpEQlET9r7eqA+ecX5kAKcvSpbiuVb34rRPpAQ5VLkb/Lf0URcQMasJ+MPI/rLSZx5wlbH5MfxxN0mbs64cbNab3EdNiZWMuaXRmbe69GheMlpBZUL+H4+chIaCSjGOVd4rvDVyKS+S/JJutmOyrxtsrmIFD07m6u07E2HGY5s+OCU92tbYTbcpzyDADfV6xwCWTXqSKlKVp9dGE5vgFOYVbHNjOiezFReY2UlBNyUOM3zClOyS8Cr0RcoOyqLwqSxAh5Lu7xOl0z3233gBZ0EhXi0XFHWDrTBxqLY8WLU6XGiQjz3V8nmj1Pg1YnPxQKYKSgV9merVJ7SWAzF+3ra2VzUhVX3CZezjX+O9SHfjfjIxRxCGHzpcgw4="
    app: work-cal
    on:
      branch: ci
