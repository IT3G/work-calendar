language: node_js
node_js:
- '12'
dist: trusty
sudo: required
branches:
  only:
  - ci
before_script:
- cd frontend
- npm install -g yarn
- npm install -g @angular/cli
script:
- yarn install
- npm run build:test
deploy:
  - provider: pages
    skip_cleanup: true
    github_token: "$GITHUB_TOKEN"
    local_dir: frontend/dist/work-calendar
    on:
      branch: ci
  - provider: heroku
    edge: true
    skip_cleanup: true
    secure: "MNgZuKJGC2/DgBHDdt6dSjxKinNUgK6oY8BkF9wL5FtbGMuzdr1SRuQs1cN+P4wFakyaT4p+pKR2PKxBE1wZ6Y79X4yzEzudknyLWuXlz31ub6CylrWurZWxyc9qI0W4yL0Xbnu7NW+iy1R+p3TX7sVPm9LmzQByXs3dlJrq1Xgt0Rv2pEObdKN432OOOVxJ9JBtP6GuyI3mm5RDw74d7hbl3qB2W9YWwQ6IQ4e7SFpdkAQQ+c93A8sP6wuOaskUy+Q2ApAJEyNm1H6WQfxuEyFXTZjIFleYqnK/Kh35HqYIImQrJzBaJCLVKqe6qquvK+6BY6nOiC+ZvJH8lAbivZxrA5BtOkZmB8Z51opG3VhRNNCqPvW0sE1qqXV1jH6iXpkoVB54Akavc2fekxrwHXhXKbVvwdNNEw9WXh6/JmWurXdQy9X0eHQDWd7ZvPleYkLOWUAfpqKJ0zTy52zBVXWOZ9BgHKcR9KgKa3RoiEbUARZgENFZFRcuxTeJunmEW9LEHHq3h53fXnwtLagp14pwMz1TAQ+mp8719evmcOWMkr6SSY2D/G/hRUAzANdT3VBqQGnzfbLjuqHM+dl0WPwQMx4PYE+AeMKotmF86mRhhB1a5oKo4LBXhlbTBEuUQKKBLl/2C6rYhoZzkOzvh/6N6ONgwUJ9mYp/lBhs+EE="
    app: work-cal
    on:
      branch: ci
